# InfluxDB 3 environment variables used by docker-compose
# Change these for your environment; do not commit secrets in public repos.
INFLUXDB_3_ADMIN_TOKEN=apiv3_testtoken123
INFLUXDB_ORG=my-org
INFLUXDB_BUCKET=my-bucket
INFLUX_BUCKET=my-bucket
INFLUXDB_ADMIN_USER=admin
INFLUXDB_ADMIN_PASSWORD=changeme
INFLUXDB_RETENTION=0
INFLUXDB_HTTP_BIND_ADDRESS=:8086
INFLUX_ORG=my-org
# Token used by the workload app to write (set to the same as INFLUXDB_3_ADMIN_TOKEN for quick test)
INFLUX_TOKEN={"token":"apiv3_testtoken123","name":"_admin"}
# If Docker Hub access is restricted in your environment, set this to an accessible mirror
# e.g. INFLUX_BASE_IMAGE=myregistry.local/influxdb:3-core
INFLUX_BASE_IMAGE=influxdb:3-core

# Workload scenario defaults (from small_ordered_same_ts)
SCENARIO=large_simul_same_ts
# High-throughput test defaults (4GB-optimized)
# Default points for quick experiments; increase for full run
POINTS=2000000
TIMESTAMP_SPAN_SEC=0
PARALLEL_CLIENTS=4
SERIES_MULTIPLIER=50
# DURATION_SEC=0 means run until all points are written
DURATION_SEC=0


# Workload run-time defaults (tweak as needed)
# Use a large batch so each client accumulates many points before flushing.
## Reduce batch size for safe memory usage during initial tests
## Tuned for ~4GB host: avoid huge transient allocations but keep good batch density
# A moderate batch reduces memory pressure; chunk sized ~64KB keeps POSTs reasonably large
BATCH_SIZE=2000
CHUNK_SIZE_BYTES=131072
MEASUREMENTS=cpu_temp,pressure,humidity
TAGS=site=lab,host=testnode
REPORT_NAME=run
# Client timer: avoid premature small flushes; set to 1s while batching
# Client timer: avoid premature small flushes; set to 500ms while batching
# Client timer: avoid premature small flushes; set to 2s for large batches
FLUSH_INTERVAL_MS=1500
# Enable gzip to reduce network payloads and server write IO (helps on low-RAM hosts)
USE_GZIP=true

# Per-writer send concurrency (parallel in-flight HTTP requests). Lowered to reduce memory and server-side queuing
SEND_CONCURRENCY=8
# Chunk size in bytes for each HTTP POST (must be <= server max-http-request-size)
## Lower chunk size to 16KB for safer test runs

# Optional: tune these from the docker-compose or environment as needed
# INFLUXDB_WAL_FLUSH_INTERVAL=10s
# INFLUXDB_WAL_BUFFER_SIZE=100000
# Optional HTTP proxy settings (uncomment and set for environments behind a proxy)
# HTTP_PROXY=http://proxy.example.com:3128
# HTTPS_PROXY=http://proxy.example.com:3128
# NO_PROXY=localhost,127.0.0.1,::1
